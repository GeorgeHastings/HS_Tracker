"use strict";var Detail={currentDeck:""},UI={loadBar:document.querySelector(".load-bar"),deckList:document.querySelector(".deck-list"),mainContainer:document.querySelector(".main-container"),deckListTmp:document.getElementById("deckListTemplate"),cardSearch:{matches:[],el:document.getElementById("cardSearch"),results:document.querySelector(".card-search-results"),cardResultTemplate:document.getElementById("cardResultTemplate"),lookUpCard:function(){var e=UI.cardSearch.el.value;if(UI.cardSearch.matches=[],e.length>2)for(var r=0;r<Cards.cardNames.length;r++)Cards.cardNames[r].toLowerCase().includes(e)&&UI.cardSearch.matches.push(Cards.cardNames[r]);UI.cardSearch.matches.length>0?UI.cardSearch.renderResults():UI.cardSearch.hideResults()},renderResults:function(){UI.cardSearch.results.innerHTML="",UI.cardSearch.results.className="card-search-results show";for(var e=0;e<UI.cardSearch.matches.length;e++){var r=UI.cardSearch.cardResultTemplate.content.cloneNode(!0);r.querySelector("li").innerText=UI.cardSearch.matches[e],r.querySelector("li").onclick=Cards.getCard,UI.cardSearch.results.appendChild(r)}},hideResults:function(){UI.cardSearch.results.className="card-search-results"}},cardList:{cardTmp:document.getElementById("cardTemplate"),el:document.querySelector(".deck-cards"),list:[],sortList:function(e,r){return e.cost<r.cost?-1:e.cost>r.cost?1:0},addCardToList:function(e){UI.cardList.list.push(e),UI.cardList.saveToDeck(),UI.cardList.renderList()},renderList:function(){if(UI.cardList.el.innerHTML="",UI.cardList.list){UI.cardList.list.sort(this.sortList);for(var e=0;e<UI.cardList.list.length;e++){var r=this.cardTmp.content.cloneNode(!0);r.querySelector("li").innerHTML=UI.cardList.list[e].name,r.querySelector("li").setAttribute("data-cost",UI.cardList.list[e].cost),r.querySelector("li").className=UI.cardList.list[e].rarity.toLowerCase(),this.el.appendChild(r)}}},saveToDeck:function(){var e=Parse.Object.extend("Deck"),r=new Parse.Query(e);r.equalTo("name",Detail.currentDeck),r.first({success:function(e){e.set("deckList",UI.cardList.list),e.save()}})}},newDeckContainer:{el:document.getElementById("newDeckContainer"),name:document.getElementById("newDeckName"),"class":document.getElementById("newDeckClass"),show:function(){UI.newDeckContainer.el.className="new-deck-container show"},hide:function(){UI.newDeckContainer.el.className="new-deck-container"}}},Cards={result:{},query:"",cardNames:[],collectNames:function(e){for(var r=0;r<e.length;r++)Cards.cardNames.push(e[r].name)},returnNames:function(e){var r=e.target.responseText,t=JSON.parse(r);Cards.collectNames(t)},buildNameArray:function(){Cards.getJSON(Cards.returnNames)},getJSON:function(e){var r=new XMLHttpRequest;r.onload=e,r.open("GET","cards.json"),r.send()},returnCard:function(e){for(var r=e.target.responseText,t=JSON.parse(r),a=0;a<t.length;a++)if(t[a].name===Cards.query){var n=t[a];UI.cardList.addCardToList(n)}},getCard:function(){Cards.query=this.innerText,Cards.getJSON(Cards.returnCard)}},Decks={createNewDeck:function(){event.preventDefault();var e=Parse.Object.extend("Deck"),r=new e;r.save({name:UI.newDeckContainer.name.value,heroClass:UI.newDeckContainer["class"].value,played:0,wins:0,losses:0,winRate:"0%"},{success:function(){Decks.pullDeckList(),UI.newDeckContainer.hide()},error:function(e,r){}})},renderDeckList:function(e){UI.deckList.innerHTML="";for(var r=0;r<e.length;r++){var t=UI.deckListTmp.content.cloneNode(!0);t.querySelector("li").setAttribute("data-index",r),t.querySelector("li").innerHTML+=e[r].get("name"),t.querySelector("li").onclick=Decks.pullDeckByIndex,UI.deckList.appendChild(t)}},pullDeckList:function(){var e=Parse.Object.extend("Deck"),r=new Parse.Query(e);r.find({success:function(e){Decks.renderDeckList(e)},error:function(e,r){console.log("something fucked up")}})},pullDeckByIndex:function(e){UI.loadBar.className="load-bar loading";var r=this.innerText,t=Parse.Object.extend("Deck"),a=new Parse.Query(t);Detail.currentDeck=r,a.equalTo("name",r),a.find({success:function(e){renderDetail(e[0])},error:function(e,r){console.log("something fucked up")}})}},renderDetail=function(e){document.getElementById("deck-portrait").className=e.get("heroClass"),UI.mainContainer.querySelector(".deck-name").innerHTML=e.get("name"),UI.mainContainer.querySelector(".played").innerHTML=e.get("played"),UI.mainContainer.querySelector(".wins").innerHTML=e.get("wins"),UI.mainContainer.querySelector(".losses").innerHTML=e.get("losses"),UI.mainContainer.querySelector(".winrate").innerHTML=e.get("winRate"),void 0!==e.get("deckList")?UI.cardList.list=e.get("deckList"):UI.cardList.list=[],UI.cardList.renderList(),UI.loadBar.className="load-bar loaded"};Cards.buildNameArray(),Decks.pullDeckList();